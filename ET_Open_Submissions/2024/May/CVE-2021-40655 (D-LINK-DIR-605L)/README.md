# ET Open Submission
### May 20th, 2024
### Sensitive information disclosure vulnerability in D-Link dir-605 Hardware（CVE-2021-40655）

## References

1. [https://www.bleepingcomputer.com/news/security/cisa-warns-of-hackers-exploiting-chrome-eol-d-link-bugs/](https://www.bleepingcomputer.com/news/security/cisa-warns-of-hackers-exploiting-chrome-eol-d-link-bugs/)
2. [https://github.com/Ilovewomen/D-LINK-DIR-605/?tab=readme-ov-file](https://github.com/Ilovewomen/D-LINK-DIR-605/?tab=readme-ov-file)


## The exploit:

![image](https://github.com/eatinsundip/Suricata/assets/43767555/a5dd4a01-d392-4aa4-afbb-26ee1c6d6619)


## Signature

Client Request: 

***Pretty much ready??***

```alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"Possible D-Link dir-605 Hardware (CVE-2021-40655) Request"; flow:established,to_server; http.method; content:"POST"; bsize:4; http.uri; content:"|2f|getcfg|2e|php"; bsize:11; http.request_body; content:"SERVICES|3d|DEVICE|2e|ACCOUNT|26|AUTHORIZED|5f|GROUP|3d|1|25|0a"; bsize:45; fast_pattern; sid:1; rev:1;)```

Server Response:

***Needs more detail from the response body but I am verifying how XML is formatted in the body.***

```alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"Possible D-Link dir-605 Hardware (CVE-2021-40655) Response"; flow:established,to_client; http.stat_code; content:"200"; http.content_type; content:"text|2f|xml"; bsize:8; http.response_body; content:"|3c|service|3e|DEVICE|2e|ACCOUNT|3c 2f|service|3e|"; rev:1;)```

## Resources

1. [pcap.zip](https://github.com/eatinsundip/Suricata/files/15380245/pcap.zip)
2. [Dalton Job](https://dalton.securitymidwest.net/dalton/coverage/job/044fe1037e72cc8d)
